import{_ as w,F as J,G as Q,K as oe,e as ce,l as U,aq as R,d as Y,b as de,a as pe,q as ue,t as he,g as fe,s as me,H as ge,ar as ye,z as Se}from"./mermaid.core.Do5pKZUp.js";import{s as xe}from"./chunk-QN33PNHL.DoknDvRG.js";import{p as ve}from"./chunk-4BX2VUAB.CDPtRC5K.js";import{p as be}from"./treemap-KMMF4GRG.DepZe48b.js";import"./_getTag.C3kekzmL.js";import{f as I}from"./defaultLocale.D2nGpDRe.js";import{o as K}from"./ordinal.BYWQX77i.js";import{h as we}from"./index.DOot-1bs.js";import"./preload-helper.BlTxHScW.js";import"./_commonjsHelpers.CqkleIqs.js";import"./min.s_JC7JUp.js";import"./_baseUniq.CHulqo6v.js";import"./_getAllKeys.DssHa7y4.js";import"./init.Gi6I4Gst.js";function Ce(l){if(typeof l!="function")throw new Error;return l}function O(){return 0}function q(l){return function(){return l}}function Te(l){l.x0=Math.round(l.x0),l.y0=Math.round(l.y0),l.x1=Math.round(l.x1),l.y1=Math.round(l.y1)}function Le(l,n,i,o,d){for(var r=l.children,c,h=-1,v=r.length,s=l.value&&(o-n)/l.value;++h<v;)c=r[h],c.y0=i,c.y1=d,c.x0=n,c.x1=n+=c.value*s}function $e(l,n,i,o,d){for(var r=l.children,c,h=-1,v=r.length,s=l.value&&(d-i)/l.value;++h<v;)c=r[h],c.x0=n,c.x1=o,c.y0=i,c.y1=i+=c.value*s}var Fe=(1+Math.sqrt(5))/2;function Me(l,n,i,o,d,r){for(var c=[],h=n.children,v,s,p=0,b=0,t=h.length,x,y,S=n.value,u,m,N,z,D,W,k;p<t;){x=d-i,y=r-o;do u=h[b++].value;while(!u&&b<t);for(m=N=u,W=Math.max(y/x,x/y)/(S*l),k=u*u*W,D=Math.max(N/k,k/m);b<t;++b){if(u+=s=h[b].value,s<m&&(m=s),s>N&&(N=s),k=u*u*W,z=Math.max(N/k,k/m),z>D){u-=s;break}D=z}c.push(v={value:u,dice:x<y,children:h.slice(p,b)}),v.dice?Le(v,i,o,d,S?o+=y*u/S:r):$e(v,i,o,S?i+=x*u/S:d,r),S-=u,p=b}return c}const ze=(function l(n){function i(o,d,r,c,h){Me(n,o,d,r,c,h)}return i.ratio=function(o){return l((o=+o)>1?o:1)},i})(Fe);function Ne(){var l=ze,n=!1,i=1,o=1,d=[0],r=O,c=O,h=O,v=O,s=O;function p(t){return t.x0=t.y0=0,t.x1=i,t.y1=o,t.eachBefore(b),d=[0],n&&t.eachBefore(Te),t}function b(t){var x=d[t.depth],y=t.x0+x,S=t.y0+x,u=t.x1-x,m=t.y1-x;u<y&&(y=u=(y+u)/2),m<S&&(S=m=(S+m)/2),t.x0=y,t.y0=S,t.x1=u,t.y1=m,t.children&&(x=d[t.depth+1]=r(t)/2,y+=s(t)-x,S+=c(t)-x,u-=h(t)-x,m-=v(t)-x,u<y&&(y=u=(y+u)/2),m<S&&(S=m=(S+m)/2),l(t,y,S,u,m))}return p.round=function(t){return arguments.length?(n=!!t,p):n},p.size=function(t){return arguments.length?(i=+t[0],o=+t[1],p):[i,o]},p.tile=function(t){return arguments.length?(l=Ce(t),p):l},p.padding=function(t){return arguments.length?p.paddingInner(t).paddingOuter(t):p.paddingInner()},p.paddingInner=function(t){return arguments.length?(r=typeof t=="function"?t:q(+t),p):r},p.paddingOuter=function(t){return arguments.length?p.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):p.paddingTop()},p.paddingTop=function(t){return arguments.length?(c=typeof t=="function"?t:q(+t),p):c},p.paddingRight=function(t){return arguments.length?(h=typeof t=="function"?t:q(+t),p):h},p.paddingBottom=function(t){return arguments.length?(v=typeof t=="function"?t:q(+t),p):v},p.paddingLeft=function(t){return arguments.length?(s=typeof t=="function"?t:q(+t),p):s},p}var ee=class{constructor(){this.nodes=[],this.levels=new Map,this.outerNodes=[],this.classes=new Map,this.setAccTitle=de,this.getAccTitle=pe,this.setDiagramTitle=ue,this.getDiagramTitle=he,this.getAccDescription=fe,this.setAccDescription=me}static{w(this,"TreeMapDB")}getNodes(){return this.nodes}getConfig(){const l=ge,n=Q();return J({...l.treemap,...n.treemap??{}})}addNode(l,n){this.nodes.push(l),this.levels.set(l,n),n===0&&(this.outerNodes.push(l),this.root??=l)}getRoot(){return{name:"",children:this.outerNodes}}addClass(l,n){const i=this.classes.get(l)??{id:l,styles:[],textStyles:[]},o=n.replace(/\\,/g,"§§§").replace(/,/g,";").replace(/§§§/g,",").split(";");o&&o.forEach(d=>{ye(d)&&(i?.textStyles?i.textStyles.push(d):i.textStyles=[d]),i?.styles?i.styles.push(d):i.styles=[d]}),this.classes.set(l,i)}getClasses(){return this.classes}getStylesForClass(l){return this.classes.get(l)?.styles??[]}clear(){Se(),this.nodes=[],this.levels=new Map,this.outerNodes=[],this.classes=new Map,this.root=void 0}};function te(l){if(!l.length)return[];const n=[],i=[];return l.forEach(o=>{const d={name:o.name,children:o.type==="Leaf"?void 0:[]};for(d.classSelector=o?.classSelector,o?.cssCompiledStyles&&(d.cssCompiledStyles=[o.cssCompiledStyles]),o.type==="Leaf"&&o.value!==void 0&&(d.value=o.value);i.length>0&&i[i.length-1].level>=o.level;)i.pop();if(i.length===0)n.push(d);else{const r=i[i.length-1].node;r.children?r.children.push(d):r.children=[d]}o.type!=="Leaf"&&i.push({node:d,level:o.level})}),n}w(te,"buildHierarchy");var ke=w((l,n)=>{ve(l,n);const i=[];for(const r of l.TreemapRows??[])r.$type==="ClassDefStatement"&&n.addClass(r.className??"",r.styleText??"");for(const r of l.TreemapRows??[]){const c=r.item;if(!c)continue;const h=r.indent?parseInt(r.indent):0,v=Ae(c),s=c.classSelector?n.getStylesForClass(c.classSelector):[],p=s.length>0?s.join(";"):void 0,b={level:h,name:v,type:c.$type,value:c.value,classSelector:c.classSelector,cssCompiledStyles:p};i.push(b)}const o=te(i),d=w((r,c)=>{for(const h of r)n.addNode(h,c),h.children&&h.children.length>0&&d(h.children,c+1)},"addNodesRecursively");d(o,0)},"populate"),Ae=w(l=>l.name?String(l.name):"","getItemName"),ae={parser:{yy:void 0},parse:w(async l=>{try{const i=await be("treemap",l);U.debug("Treemap AST:",i);const o=ae.parser?.yy;if(!(o instanceof ee))throw new Error("parser.parser?.yy was not a TreemapDB. This is due to a bug within Mermaid, please report this issue at https://github.com/mermaid-js/mermaid/issues.");ke(i,o)}catch(n){throw U.error("Error parsing treemap:",n),n}},"parse")},Ve=10,E=10,G=25,De=w((l,n,i,o)=>{const d=o.db,r=d.getConfig(),c=r.padding??Ve,h=d.getDiagramTitle(),v=d.getRoot(),{themeVariables:s}=Q();if(!v)return;const p=h?30:0,b=oe(n),t=r.nodeWidth?r.nodeWidth*E:960,x=r.nodeHeight?r.nodeHeight*E:500,y=t,S=x+p;b.attr("viewBox",`0 0 ${y} ${S}`),ce(b,S,y,r.useMaxWidth);let u;try{const e=r.valueFormat||",";if(e==="$0,0")u=w(a=>"$"+I(",")(a),"valueFormat");else if(e.startsWith("$")&&e.includes(",")){const a=/\.\d+/.exec(e),f=a?a[0]:"";u=w(C=>"$"+I(","+f)(C),"valueFormat")}else if(e.startsWith("$")){const a=e.substring(1);u=w(f=>"$"+I(a||"")(f),"valueFormat")}else u=I(e)}catch(e){U.error("Error creating format function:",e),u=I(",")}const m=K().range(["transparent",s.cScale0,s.cScale1,s.cScale2,s.cScale3,s.cScale4,s.cScale5,s.cScale6,s.cScale7,s.cScale8,s.cScale9,s.cScale10,s.cScale11]),N=K().range(["transparent",s.cScalePeer0,s.cScalePeer1,s.cScalePeer2,s.cScalePeer3,s.cScalePeer4,s.cScalePeer5,s.cScalePeer6,s.cScalePeer7,s.cScalePeer8,s.cScalePeer9,s.cScalePeer10,s.cScalePeer11]),z=K().range([s.cScaleLabel0,s.cScaleLabel1,s.cScaleLabel2,s.cScaleLabel3,s.cScaleLabel4,s.cScaleLabel5,s.cScaleLabel6,s.cScaleLabel7,s.cScaleLabel8,s.cScaleLabel9,s.cScaleLabel10,s.cScaleLabel11]);h&&b.append("text").attr("x",y/2).attr("y",p/2).attr("class","treemapTitle").attr("text-anchor","middle").attr("dominant-baseline","middle").text(h);const D=b.append("g").attr("transform",`translate(0, ${p})`).attr("class","treemapContainer"),W=we(v).sum(e=>e.value??0).sort((e,a)=>(a.value??0)-(e.value??0)),Z=Ne().size([t,x]).paddingTop(e=>e.children&&e.children.length>0?G+E:0).paddingInner(c).paddingLeft(e=>e.children&&e.children.length>0?E:0).paddingRight(e=>e.children&&e.children.length>0?E:0).paddingBottom(e=>e.children&&e.children.length>0?E:0).round(!0)(W),le=Z.descendants().filter(e=>e.children&&e.children.length>0),B=D.selectAll(".treemapSection").data(le).enter().append("g").attr("class","treemapSection").attr("transform",e=>`translate(${e.x0},${e.y0})`);B.append("rect").attr("width",e=>e.x1-e.x0).attr("height",G).attr("class","treemapSectionHeader").attr("fill","none").attr("fill-opacity",.6).attr("stroke-width",.6).attr("style",e=>e.depth===0?"display: none;":""),B.append("clipPath").attr("id",(e,a)=>`clip-section-${n}-${a}`).append("rect").attr("width",e=>Math.max(0,e.x1-e.x0-12)).attr("height",G),B.append("rect").attr("width",e=>e.x1-e.x0).attr("height",e=>e.y1-e.y0).attr("class",(e,a)=>`treemapSection section${a}`).attr("fill",e=>m(e.data.name)).attr("fill-opacity",.6).attr("stroke",e=>N(e.data.name)).attr("stroke-width",2).attr("stroke-opacity",.4).attr("style",e=>{if(e.depth===0)return"display: none;";const a=R({cssCompiledStyles:e.data.cssCompiledStyles});return a.nodeStyles+";"+a.borderStyles.join(";")}),B.append("text").attr("class","treemapSectionLabel").attr("x",6).attr("y",G/2).attr("dominant-baseline","middle").text(e=>e.depth===0?"":e.data.name).attr("font-weight","bold").attr("style",e=>{if(e.depth===0)return"display: none;";const a="dominant-baseline: middle; font-size: 12px; fill:"+z(e.data.name)+"; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;",f=R({cssCompiledStyles:e.data.cssCompiledStyles});return a+f.labelStyles.replace("color:","fill:")}).each(function(e){if(e.depth===0)return;const a=Y(this),f=e.data.name;a.text(f);const C=e.x1-e.x0,L=6;let $;r.showValues!==!1&&e.value?$=C-10-30-10-L:$=C-L-6;const F=Math.max(15,$),g=a.node();if(g.getComputedTextLength()>F){let T=f;for(;T.length>0;){if(T=f.substring(0,T.length-1),T.length===0){a.text("..."),g.getComputedTextLength()>F&&a.text("");break}if(a.text(T+"..."),g.getComputedTextLength()<=F)break}}}),r.showValues!==!1&&B.append("text").attr("class","treemapSectionValue").attr("x",e=>e.x1-e.x0-10).attr("y",G/2).attr("text-anchor","end").attr("dominant-baseline","middle").text(e=>e.value?u(e.value):"").attr("font-style","italic").attr("style",e=>{if(e.depth===0)return"display: none;";const a="text-anchor: end; dominant-baseline: middle; font-size: 10px; fill:"+z(e.data.name)+"; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;",f=R({cssCompiledStyles:e.data.cssCompiledStyles});return a+f.labelStyles.replace("color:","fill:")});const ne=Z.leaves(),X=D.selectAll(".treemapLeafGroup").data(ne).enter().append("g").attr("class",(e,a)=>`treemapNode treemapLeafGroup leaf${a}${e.data.classSelector?` ${e.data.classSelector}`:""}x`).attr("transform",e=>`translate(${e.x0},${e.y0})`);X.append("rect").attr("width",e=>e.x1-e.x0).attr("height",e=>e.y1-e.y0).attr("class","treemapLeaf").attr("fill",e=>e.parent?m(e.parent.data.name):m(e.data.name)).attr("style",e=>R({cssCompiledStyles:e.data.cssCompiledStyles}).nodeStyles).attr("fill-opacity",.3).attr("stroke",e=>e.parent?m(e.parent.data.name):m(e.data.name)).attr("stroke-width",3),X.append("clipPath").attr("id",(e,a)=>`clip-${n}-${a}`).append("rect").attr("width",e=>Math.max(0,e.x1-e.x0-4)).attr("height",e=>Math.max(0,e.y1-e.y0-4)),X.append("text").attr("class","treemapLabel").attr("x",e=>(e.x1-e.x0)/2).attr("y",e=>(e.y1-e.y0)/2).attr("style",e=>{const a="text-anchor: middle; dominant-baseline: middle; font-size: 38px;fill:"+z(e.data.name)+";",f=R({cssCompiledStyles:e.data.cssCompiledStyles});return a+f.labelStyles.replace("color:","fill:")}).attr("clip-path",(e,a)=>`url(#clip-${n}-${a})`).text(e=>e.data.name).each(function(e){const a=Y(this),f=e.x1-e.x0,C=e.y1-e.y0,L=a.node(),$=4,P=f-2*$,F=C-2*$;if(P<10||F<10){a.style("display","none");return}let g=parseInt(a.style("font-size"),10);const A=8,M=28,T=.6,V=6,_=2;for(;L.getComputedTextLength()>P&&g>A;)g--,a.style("font-size",`${g}px`);let H=Math.max(V,Math.min(M,Math.round(g*T))),j=g+_+H;for(;j>F&&g>A&&(g--,H=Math.max(V,Math.min(M,Math.round(g*T))),!(H<V&&g===A));)a.style("font-size",`${g}px`),j=g+_+H;a.style("font-size",`${g}px`),(L.getComputedTextLength()>P||g<A||F<g)&&a.style("display","none")}),r.showValues!==!1&&X.append("text").attr("class","treemapValue").attr("x",a=>(a.x1-a.x0)/2).attr("y",function(a){return(a.y1-a.y0)/2}).attr("style",a=>{const f="text-anchor: middle; dominant-baseline: hanging; font-size: 28px;fill:"+z(a.data.name)+";",C=R({cssCompiledStyles:a.data.cssCompiledStyles});return f+C.labelStyles.replace("color:","fill:")}).attr("clip-path",(a,f)=>`url(#clip-${n}-${f})`).text(a=>a.value?u(a.value):"").each(function(a){const f=Y(this),C=this.parentNode;if(!C){f.style("display","none");return}const L=Y(C).select(".treemapLabel");if(L.empty()||L.style("display")==="none"){f.style("display","none");return}const $=parseFloat(L.style("font-size")),P=28,F=.6,g=6,A=2,M=Math.max(g,Math.min(P,Math.round($*F)));f.style("font-size",`${M}px`);const V=(a.y1-a.y0)/2+$/2+A;f.attr("y",V);const _=a.x1-a.x0,re=a.y1-a.y0-4,ie=_-8;f.node().getComputedTextLength()>ie||V+M>re||M<g?f.style("display","none"):f.style("display",null)});const se=r.diagramPadding??8;xe(b,se,"flowchart",r?.useMaxWidth||!1)},"draw"),Pe=w(function(l,n){return n.db.getClasses()},"getClasses"),Re={draw:De,getClasses:Pe},Ee={sectionStrokeColor:"black",sectionStrokeWidth:"1",sectionFillColor:"#efefef",leafStrokeColor:"black",leafStrokeWidth:"1",leafFillColor:"#efefef",labelColor:"black",labelFontSize:"12px",valueFontSize:"10px",valueColor:"black",titleColor:"black",titleFontSize:"14px"},We=w(({treemap:l}={})=>{const n=J(Ee,l);return`
  .treemapNode.section {
    stroke: ${n.sectionStrokeColor};
    stroke-width: ${n.sectionStrokeWidth};
    fill: ${n.sectionFillColor};
  }
  .treemapNode.leaf {
    stroke: ${n.leafStrokeColor};
    stroke-width: ${n.leafStrokeWidth};
    fill: ${n.leafFillColor};
  }
  .treemapLabel {
    fill: ${n.labelColor};
    font-size: ${n.labelFontSize};
  }
  .treemapValue {
    fill: ${n.valueColor};
    font-size: ${n.valueFontSize};
  }
  .treemapTitle {
    fill: ${n.titleColor};
    font-size: ${n.titleFontSize};
  }
  `},"getStyles"),Be=We,tt={parser:ae,get db(){return new ee},renderer:Re,styles:Be};export{tt as diagram};
