import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{u as x,D as h,a as g}from"./useKeyboardShortcut.DCroO9rU.js";import{c as j}from"./code-block-enhancer.DP3lGJ60.js";import{c as f}from"./utils.BpMRZbEX.js";import{u as v}from"./index.CTdVSFIz.js";import{c as u,$ as w,o as b}from"./modal.BeECZm2d.js";import{r as a}from"./index.D6whbu08.js";import{A as k}from"./index.s74VRsaB.js";import{m as p}from"./proxy.C2vk4wBE.js";import"./design-tokens.Dn6fllXW.js";import"./index.TWhk7goS.js";import"./index.Bn74zGeF.js";import"./_commonjsHelpers.CqkleIqs.js";import"./index.BFlOlsrl.js";import"./index.BHh4vvK5.js";import"./index.3whys8t3.js";function y({className:t}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 448 512",fill:"currentColor",className:t,children:[e.jsx("title",{children:"Copy"}),e.jsx("path",{d:"M192 0c-35.3 0-64 28.7-64 64l0 256c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-200.6c0-17.4-7.1-34.1-19.7-46.2L370.6 17.8C358.7 6.4 342.8 0 326.3 0L192 0zM64 128c-35.3 0-64 28.7-64 64L0 448c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-16-64 0 0 16-192 0 0-256 16 0 0-64-16 0z"})]})}function C({className:t}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",className:t,children:[e.jsx("title",{children:"Copied"}),e.jsx("mask",{id:"checkmark-anim-fullscreen",children:e.jsxs("g",{fill:"none",stroke:"#fff",strokeDasharray:"24",strokeDashoffset:"24",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",children:[e.jsx("path",{d:"M2 13.5l4 4l10.75 -10.75",children:e.jsx("animate",{fill:"freeze",attributeName:"stroke-dashoffset",dur:"0.4s",values:"24;0"})}),e.jsx("path",{stroke:"#000",strokeWidth:"6",d:"M7.5 13.5l4 4l10.75 -10.75",children:e.jsx("animate",{fill:"freeze",attributeName:"stroke-dashoffset",begin:"0.4s",dur:"0.4s",values:"24;0"})}),e.jsx("path",{d:"M7.5 13.5l4 4l10.75 -10.75",children:e.jsx("animate",{fill:"freeze",attributeName:"stroke-dashoffset",begin:"0.4s",dur:"0.4s",values:"24;0"})})]})}),e.jsx("rect",{width:"24",height:"24",fill:"currentColor",mask:"url(#checkmark-anim-fullscreen)"})]})}function L({className:t}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:t,children:[e.jsx("title",{children:"Close"}),e.jsx("path",{d:"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z"})]})}function N(t){if(!t)return{};const r={},i=t.split(";").filter(o=>o.trim());for(const o of i){const l=o.indexOf(":");if(l===-1)continue;const n=o.slice(0,l).trim(),c=o.slice(l+1).trim();if(!n||!c)continue;const d=n.replace(/-([a-z])/g,(s,m)=>m.toUpperCase());r[d]=c}return r}function K(){const t=v(w),r=t!==null,[i,o]=a.useState(!1);x(()=>{r&&u()},r),a.useEffect(()=>{const s=m=>{b("codeFullscreen",m.detail)};return window.addEventListener("open-code-fullscreen",s),()=>{window.removeEventListener("open-code-fullscreen",s)}},[]),a.useEffect(()=>{const s=()=>{r&&u()};return document.addEventListener("astro:before-preparation",s),()=>{document.removeEventListener("astro:before-preparation",s)}},[r]);const l=a.useCallback(async()=>{if(!t)return;await j(t.code)&&(o(!0),setTimeout(()=>o(!1),2e3))},[t]),n=a.useCallback(()=>{u()},[]),c=a.useCallback(s=>{s.target===s.currentTarget&&n()},[n]);if(!t)return null;const d=N(t.preStyle);return e.jsx(h,{open:r,onOpenChange:s=>!s&&n(),children:e.jsx(g,{forceMount:!0,children:e.jsx(k,{children:r&&e.jsxs(e.Fragment,{children:[e.jsx(p.div,{className:"fixed inset-0 z-40 bg-black/80 backdrop-blur-sm",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2}}),e.jsx(p.div,{className:"fixed inset-0 z-50 grid place-items-center px-4",onClick:c,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:e.jsxs(p.div,{className:"relative flex h-[85vh] w-[90vw] max-w-6xl flex-col overflow-hidden rounded-xl bg-background shadow-2xl md:max-w-[90vw]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},children:[e.jsxs("div",{className:"flex shrink-0 items-center justify-between border-border border-b bg-muted/50 px-4 py-3 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"h-3 w-3 rounded-full bg-[#ff5f56]"}),e.jsx("span",{className:"h-3 w-3 rounded-full bg-[#ffbd2e]"}),e.jsx("span",{className:"h-3 w-3 rounded-full bg-[#27c93f]"})]}),e.jsx("span",{className:"font-medium font-mono text-muted-foreground text-xs uppercase tracking-wider",children:t.language})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("button",{type:"button",onClick:l,className:f("flex items-center gap-2 rounded-md px-3 py-1.5 text-muted-foreground transition-colors hover:bg-accent hover:text-accent-foreground",i&&"text-primary"),children:[i?e.jsx(C,{}):e.jsx(y,{}),e.jsx("span",{className:"text-sm",children:i?"已复制":"复制"})]}),e.jsx("button",{type:"button",onClick:n,className:"rounded-md p-2 text-muted-foreground transition-colors hover:bg-accent hover:text-accent-foreground","aria-label":"关闭",children:e.jsx(L,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"scroll-feather-mask flex-1 overflow-auto",children:e.jsx("pre",{className:f(t.preClassName,"p-4"),style:d,children:e.jsx("code",{className:t.codeClassName,dangerouslySetInnerHTML:{__html:t.codeHTML}})})})]})})]})})})})}export{K as default};
