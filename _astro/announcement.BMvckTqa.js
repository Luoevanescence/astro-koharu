import{c as s}from"./index.BHh4vvK5.js";import{a}from"./index.3whys8t3.js";const d=[].map(t=>({id:t.id,title:t.title,content:t.content,type:t.type,publishDate:t.publishDate,startDate:t.startDate,endDate:t.endDate,priority:t.priority,link:t.link,color:t.color})),r="announcement-read-ids",o=a(new Set),u=a(!1),i=a(!1);function f(t){const e=new Date;if(t.startDate){const n=new Date(t.startDate);if(e<n)return!1}if(t.endDate){const n=new Date(t.endDate);if(e>n)return!1}return!0}const c=s(o,()=>d.filter(f).sort((t,e)=>(e.priority??0)-(t.priority??0))),l=s([c,o],(t,e)=>t.filter(n=>!e.has(n.id))),S=s(l,t=>t.length);function m(){if(!(typeof window>"u"))try{const t=localStorage.getItem(r);if(t){const e=JSON.parse(t);o.set(new Set(e))}}catch(t){console.warn("[Announcement] Failed to parse stored read IDs",t)}}function A(){m(),u.set(!0)}function g(t){const e=o.get();if(e.has(t))return;const n=new Set(e);n.add(t),o.set(n),typeof localStorage<"u"&&localStorage.setItem(r,JSON.stringify([...n]))}function y(){i.set(!0)}function w(){i.set(!1)}function I(){const t=c.get(),e=new Set(o.get());for(const n of t)e.add(n.id);o.set(e),typeof localStorage<"u"&&localStorage.setItem(r,JSON.stringify([...e]))}export{c as a,i as b,w as c,g as d,u as e,l as f,A as i,I as m,y as o,o as r,S as u};
